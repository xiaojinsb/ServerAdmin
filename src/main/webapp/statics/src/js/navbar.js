layui.define(["layer","laytpl","element"],function(exports){var $=layui.jquery,layer=layui.layer,_modName="navbar",_win=$(window),_doc=$(document),laytpl=layui.laytpl,element=layui.element;var navbar={v:"1.0.5",config:{data:undefined,remote:{url:undefined,type:"GET",jsonp:false},cached:false,elem:undefined,filter:"kitNavbar"},set:function(options){var that=this;that.config.data=undefined;$.extend(true,that.config,options);return that},hasElem:function(){var that=this,_config=that.config;if(_config.elem===undefined&&_doc.find("ul[kit-navbar]").length===0&&$(_config.elem)){layui.hint().error("Navbar error:请配置Navbar容器.");return false}return true},getElem:function(){var _config=this.config;return(_config.elem!==undefined&&$(_config.elem).length>0)?$(_config.elem):_doc.find("ul[kit-navbar]")},bind:function(callback,params){var that=this,_config=that.config;var defaults={target:undefined,showTips:true};$.extend(true,defaults,params);var _target=defaults.target===undefined?_doc:$(defaults.target);_target.find("a[kit-target]").each(function(){var _that=$(this),tipsId=undefined;if(defaults.showTips){_that.hover(function(){if(_that.parents(".kit-sided").length>0){tipsId=layer.tips($(this).children("span").text(),this)}},function(){if(tipsId){layer.close(tipsId)}})}_that.off("click").on("click",function(){var options=_that.data("options");var data;if(options!==undefined){try{data=new Function("return "+options)()}catch(e){layui.hint().error("Navbar 组件a[data-options]配置项存在语法错误："+options)}}else{data={icon:_that.data("icon"),id:_that.data("id"),title:_that.data("title"),url:_that.data("url"),}}typeof callback==="function"&&callback(data)})});$(".kit-side-fold").off("click").on("click",function(){var _side=_doc.find("div.kit-side");if(_side.hasClass("kit-sided")){_side.removeClass("kit-sided");_doc.find("div.layui-body").removeClass("kit-body-folded");_doc.find("div.layui-footer").removeClass("kit-footer-folded")}else{_side.addClass("kit-sided");_doc.find("div.layui-body").addClass("kit-body-folded");_doc.find("div.layui-footer").addClass("kit-footer-folded")}});return that},render:function(callback){var that=this,_config=that.config,_remote=_config.remote,_tpl=["{{# layui.each(d,function(index, item){ }}","{{# if(item.spread){ }}",'<li class="layui-nav-item layui-nav-itemed">',"{{# }else{ }}",'<li class="layui-nav-item">',"{{# } }}","{{# var hasChildren = item.list!==undefined && item.list.length>0; }}","{{# if(hasChildren){ }}",'<a href="javascript:;">','{{# if (item.icon.indexOf("fa-") !== -1) { }}','<i class="fa {{item.icon}}" aria-hidden="true"></i>',"{{# } else { }}",'<i class="layui-icon">{{item.icon}}</i>',"{{# } }}","<span> {{item.menuName}}</span>","</a>","{{# var children = item.list; }}",'<dl class="layui-nav-child">',"{{# layui.each(children,function(childIndex, child){ }}","<dd>","<a href=\"javascript:;\" kit-target data-options=\"{url:'{{child.url}}',icon:'{{child.icon}}',title:'{{child.menuName}}',id:'{{child.menuId}}'}\">",'{{# if (child.icon.indexOf("fa-") !== -1) { }}','<i class="fa {{child.icon}}" aria-hidden="true"></i>',"{{# } else { }}",'<i class="layui-icon">{{child.icon}}</i>',"{{# } }}","<span> {{child.menuName}}</span>","</a>","</dd>","{{# }); }}","</dl>","{{# }else{ }}","<a href=\"javascript:;\" kit-target data-options=\"{url:'{{item.url}}',icon:'{{item.icon}}',title:'{{item.menuName}}',id:'{{item.menuId}}'}\">",'{{# if (item.icon.indexOf("fa-") !== -1) { }}','<i class="fa {{item.icon}}" aria-hidden="true"></i>',"{{# } else { }}",'<i class="layui-icon">{{item.icon}}</i>',"{{# } }}","<span> {{item.menuName}}</span>","</a>","{{# } }}","</li>","{{# }); }}",],_data=[];var navbarLoadIndex=layer.load(2);if(!that.hasElem()){return that}var _elem=that.getElem();if(_config.data!==undefined&&_config.data.length>0){_data=_config.data}else{var dataType=_remote.jsonp?"jsonp":"json";var options={url:_remote.url,type:_remote.type,error:function(xhr,status,thrown){layui.hint().error("Navbar error:AJAX请求出错."+thrown);navbarLoadIndex&&layer.close(navbarLoadIndex)},success:function(res){_data=res}};$.extend(true,options,_remote.jsonp?{dataType:"jsonp",jsonp:"callback",jsonpCallback:"jsonpCallback"}:{dataType:"json"});$.support.cors=true;$.ajax(options)}var tIndex=setInterval(function(){if(_data.length>0){clearInterval(tIndex);laytpl(_tpl.join("")).render(_data,function(html){_elem.html(html);element.init();that.bind(function(data){typeof callback==="function"&&callback(data)});navbarLoadIndex&&layer.close(navbarLoadIndex)})}},50);return that}};exports(_modName,navbar)});